# Sprint 5.2 — Recurring Tasks + Data Export Design

## Recurring Tasks

**Schema:** Add three columns to `todos` table:
- `recurrence_rule` (text, nullable) — `daily`, `weekly`, `monthly`, or `null`
- `recurrence_end_date` (text, nullable) — stop generating occurrences after this date
- `parent_todo_id` (uuid, nullable, self-ref FK) — links generated occurrences back to the original recurring todo

**Occurrence generation:** Triggered immediately inside `toggleTodoComplete()` when a recurring todo is marked done:
1. Calculate next due date: current `due_date` + interval (1 day / 7 days / 1 month)
2. If `recurrence_end_date` is set and next date exceeds it, do not generate
3. Clone the todo: same title, description, project, priority, recurrence_rule, recurrence_end_date, parent_todo_id (pointing to original), new due_date, `completed=false`

No cron job needed — generation is synchronous on completion.

**UI:**
- Recurrence selector (None/Daily/Weekly/Monthly) in todo create/edit form
- Repeat icon displayed on recurring todos in the list
- Optional end date picker shown when recurrence is selected

## Data Export (GDPR)

**API route:** `GET /api/export/data` — authenticated, returns all user data as a JSON file download.

**Exported data:** User profile, workspaces (where member), todos, timesheet entries, comments, attachments metadata, notification preferences. Single JSON file, no ZIP needed.

**UI:** "Export My Data" button on workspace settings page.

## Onboarding Checklist

**Storage:** Add `onboarding` JSON column to `users` table. Shape: `{ created_project?: boolean, added_todo?: boolean, tried_voice?: boolean, invited_member?: boolean, dismissed?: boolean }`.

**Steps (4 items):** Create a project, Add a todo, Try voice capture, Invite a team member.

**UI:** Dismissible card on dashboard showing progress bar and links to each action. Hidden once all steps are complete or user dismisses. Auto-updates when user completes actions (checked on dashboard load via existing loaders).
